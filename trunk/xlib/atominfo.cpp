//----------------------------------------------------------------------------//
// TBasicAtomsInfo  - basic atom data
// (c) Oleg V. Dolomanov, 2004
//----------------------------------------------------------------------------//

#ifdef __BORLANDC__
#pragma hdrstop
#endif

#include "atominfo.h"
#include "efile.h"
#include "estrlist.h"
#include "exception.h"
#include "bapp.h"
#include <stdlib.h>
// RGBA

int Colors[]={
          0xffffff, // white
          0x008000,
          0x0000ff,
          0xff0000,
          0x00ffff,
          0x800080,
          0xffffff,
          0x808080,
          0x808000,
          0x008000,
          0x800000,
          0x00ffff,
          0x0000ff,
          0x000000
};

TAtomsInfo* TAtomsInfo::Instance = NULL;
//---------------------------------------------------------------------------
// TBasicAtomInfo function bodies
//---------------------------------------------------------------------------

TBasicAtomInfo::TBasicAtomInfo()  {
  Isotopes = NULL;
}
//..............................................................................
TBasicAtomInfo::~TBasicAtomInfo()  {
  if( Isotopes != NULL )
    delete Isotopes;
}
//..............................................................................
TIsotope& TBasicAtomInfo::NewIsotope()  {
  if( Isotopes == NULL )  Isotopes = new TIsotopeList;
  return Isotopes->AddNew();
}
olxstr TBasicAtomInfo::StrRepr() const  {
  olxstr Tmp;
  olxstr Tmp1;
  Tmp1 = GetSymbol();    Tmp.Format(3, true, ' ');
  Tmp = Tmp1;
  Tmp1 = GetMr();        Tmp << Tmp1.Format(14, true, ' ');
  Tmp1 = GetName();      Tmp << Tmp1.Format(12, true, ' ');
  Tmp1 = GetDefColor();  Tmp << Tmp1.Format(12, true, ' ');
  Tmp1 = GetRad();       Tmp << Tmp1.Format(6, true, ' ');
  Tmp1 = GetRad1();      Tmp << Tmp1.Format(6, true, ' ');
  Tmp1 = GetRad2();      Tmp << Tmp1.Format(6, true, ' ');
  if( Isotopes != NULL )  {
    for( int i=0; i < Isotopes->Count(); i++ )  {
      Tmp1 = Isotopes->Item(i).GetMr();
      Tmp << Tmp1.Format(14, true, ' ');
      Tmp1 = Isotopes->Item(i).GetW()*100;
      Tmp << Tmp1.Format(8, true, ' ');
    }
  }
  return Tmp;
}
//..............................................................................
//---------------------------------------------------------------------------
// TAtomsInfo function bodies
//---------------------------------------------------------------------------
//---------------------------------------------------------------------------
TAtomsInfo::TAtomsInfo(const olxstr &filename)  {
  if( !filename.IsEmpty() && TEFile::FileExists(filename) )  {
    olxstr Tmp;
    TCStrList List, Toks;
    int color;
    List.LoadFromFile(filename);
    if( List.Count() < 100 )
      throw TInvalidArgumentException(__OlxSourceInfo, "unexpected end of the stream");
    for( int i=1; i< List.Count(); i++ )  {
      Toks.Clear();
      Toks.Strtok(List[i], ' ');
      if( Toks.Count() >= 7 )  {
        TBasicAtomInfo& I = Data.AddNew();
        I.SetSymbol( Toks.String(0) );
        I.SetMr( Toks[1].ToDouble() );
        I.SetName( Toks[2] );
        color = Toks[3].ToInt();
        if(  color >= 1 && color <= 14 )
          I.SetDefColor( Colors[color] );
        I.SetRad( Toks[4].ToDouble() );
        I.SetRad1( Toks[5].ToDouble() );
        I.SetRad2( Toks[6].ToDouble() );
        I.SetIndex( (short)(i-1) );
        if( Toks.Count() > 7 )  {
          for( int j=7; j < Toks.Count(); j+=2 )  {
            TIsotope& Is = I.NewIsotope();
            Is.SetMr( Toks[j].ToDouble() );
            Is.SetW( Toks[j+1].ToDouble()/100 );
          }
        }
      }
    }
  }
  else  {
    TBasicAtomInfo* bai = &Data.AddNew();
    bai->SetSymbol("H");
    bai->SetName("Hydrogen");
    bai->SetMr(1.0079);
    bai->SetDefColor(0xFFFFFF);
    bai->SetRad(0.12);
    bai->SetRad1(0.32);
    bai->SetRad2(0.82);
    bai->SetIndex(0);
      TIsotope* ai = &bai->NewIsotope();
      ai->SetMr(1.007825);
      ai->SetW(0.99989);
      ai = &bai->NewIsotope();
      ai->SetMr(2.014102);
      ai->SetW(0.000115);
    bai = &Data.AddNew();
    bai->SetSymbol("He");
    bai->SetName("Helium");
    bai->SetMr(4.0026);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.5);
    bai->SetRad2(2);
    bai->SetIndex(1);
      ai = &bai->NewIsotope();
      ai->SetMr(3.016029);
      ai->SetW(0.000001);
      ai = &bai->NewIsotope();
      ai->SetMr(4.002603);
      ai->SetW(0.999999);
    bai = &Data.AddNew();
    bai->SetSymbol("Li");
    bai->SetName("Lithium");
    bai->SetMr(6.941);
    bai->SetDefColor(0x800080);
    bai->SetRad(0.16);
    bai->SetRad1(1.52);
    bai->SetRad2(2.02);
    bai->SetIndex(2);
      ai = &bai->NewIsotope();
      ai->SetMr(6.015121);
      ai->SetW(0.0759);
      ai = &bai->NewIsotope();
      ai->SetMr(7.016003);
      ai->SetW(0.9241);
    bai = &Data.AddNew();
    bai->SetSymbol("Be");
    bai->SetName("Beryllium");
    bai->SetMr(9.01218);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.11);
    bai->SetRad2(1.61);
    bai->SetIndex(3);
      ai = &bai->NewIsotope();
      ai->SetMr(9.012182);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("B");
    bai->SetName("Boron");
    bai->SetMr(10.81);
    bai->SetDefColor(0xFFFF);
    bai->SetRad(0.2);
    bai->SetRad1(0.82);
    bai->SetRad2(1.32);
    bai->SetIndex(4);
      ai = &bai->NewIsotope();
      ai->SetMr(10.012937);
      ai->SetW(0.199);
      ai = &bai->NewIsotope();
      ai->SetMr(11.009305);
      ai->SetW(0.8022);
    bai = &Data.AddNew();
    bai->SetSymbol("C");
    bai->SetName("Carbon");
    bai->SetMr(12.011);
    bai->SetDefColor(0x0);
    bai->SetRad(0.2);
    bai->SetRad1(0.77);
    bai->SetRad2(1.27);
    bai->SetIndex(5);
      ai = &bai->NewIsotope();
      ai->SetMr(12);
      ai->SetW(0.9889);
      ai = &bai->NewIsotope();
      ai->SetMr(13.003355);
      ai->SetW(0.0111);
    bai = &Data.AddNew();
    bai->SetSymbol("N");
    bai->SetName("Nitrogen");
    bai->SetMr(14.0067);
    bai->SetDefColor(0xFF0000);
    bai->SetRad(0.2);
    bai->SetRad1(0.7);
    bai->SetRad2(1.2);
    bai->SetIndex(6);
      ai = &bai->NewIsotope();
      ai->SetMr(14.003074);
      ai->SetW(0.99632);
      ai = &bai->NewIsotope();
      ai->SetMr(15.000109);
      ai->SetW(0.00368);
    bai = &Data.AddNew();
    bai->SetSymbol("O");
    bai->SetName("Oxygen");
    bai->SetMr(15.9994);
    bai->SetDefColor(0xFF);
    bai->SetRad(0.2);
    bai->SetRad1(0.66);
    bai->SetRad2(1.16);
    bai->SetIndex(7);
      ai = &bai->NewIsotope();
      ai->SetMr(15.994915);
      ai->SetW(0.99757);
      ai = &bai->NewIsotope();
      ai->SetMr(16.999131);
      ai->SetW(0.00038);
      ai = &bai->NewIsotope();
      ai->SetMr(17.99916);
      ai->SetW(0.00205);
    bai = &Data.AddNew();
    bai->SetSymbol("F");
    bai->SetName("Fluorine");
    bai->SetMr(18.9984);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.2);
    bai->SetRad1(0.64);
    bai->SetRad2(1.14);
    bai->SetIndex(8);
      ai = &bai->NewIsotope();
      ai->SetMr(18.998403);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Ne");
    bai->SetName("Neon");
    bai->SetMr(20.179);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.5);
    bai->SetRad2(2);
    bai->SetIndex(9);
      ai = &bai->NewIsotope();
      ai->SetMr(19.992436);
      ai->SetW(0.9048);
      ai = &bai->NewIsotope();
      ai->SetMr(20.993843);
      ai->SetW(0.0027);
      ai = &bai->NewIsotope();
      ai->SetMr(21.991383);
      ai->SetW(0.0925);
    bai = &Data.AddNew();
    bai->SetSymbol("Na");
    bai->SetName("Sodium");
    bai->SetMr(22.98977);
    bai->SetDefColor(0x808000);
    bai->SetRad(0.2);
    bai->SetRad1(1.86);
    bai->SetRad2(2.36);
    bai->SetIndex(10);
      ai = &bai->NewIsotope();
      ai->SetMr(22.989768);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Mg");
    bai->SetName("Magnesium");
    bai->SetMr(24.305);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.25);
    bai->SetRad1(1.6);
    bai->SetRad2(2.1);
    bai->SetIndex(11);
      ai = &bai->NewIsotope();
      ai->SetMr(23.985042);
      ai->SetW(0.7899);
      ai = &bai->NewIsotope();
      ai->SetMr(24.985837);
      ai->SetW(0.1);
      ai = &bai->NewIsotope();
      ai->SetMr(25.982594);
      ai->SetW(0.1101);
    bai = &Data.AddNew();
    bai->SetSymbol("Al");
    bai->SetName("Aluminium");
    bai->SetMr(26.98154);
    bai->SetDefColor(0x808000);
    bai->SetRad(0.25);
    bai->SetRad1(1.25);
    bai->SetRad2(1.75);
    bai->SetIndex(12);
      ai = &bai->NewIsotope();
      ai->SetMr(26.981539);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Si");
    bai->SetName("Silicon");
    bai->SetMr(28.086);
    bai->SetDefColor(0xFF);
    bai->SetRad(0.3);
    bai->SetRad1(1.17);
    bai->SetRad2(1.67);
    bai->SetIndex(13);
      ai = &bai->NewIsotope();
      ai->SetMr(27.976927);
      ai->SetW(0.922297);
      ai = &bai->NewIsotope();
      ai->SetMr(28.976495);
      ai->SetW(0.046832);
      ai = &bai->NewIsotope();
      ai->SetMr(29.973771);
      ai->SetW(0.030872);
    bai = &Data.AddNew();
    bai->SetSymbol("P");
    bai->SetName("Phosphorus");
    bai->SetMr(30.97376);
    bai->SetDefColor(0x800080);
    bai->SetRad(0.3);
    bai->SetRad1(1.1);
    bai->SetRad2(1.6);
    bai->SetIndex(14);
      ai = &bai->NewIsotope();
      ai->SetMr(30.973762);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("S");
    bai->SetName("Sulfur");
    bai->SetMr(32.06);
    bai->SetDefColor(0xFFFF);
    bai->SetRad(0.3);
    bai->SetRad1(1.03);
    bai->SetRad2(1.53);
    bai->SetIndex(15);
      ai = &bai->NewIsotope();
      ai->SetMr(31.972071);
      ai->SetW(0.9493);
      ai = &bai->NewIsotope();
      ai->SetMr(32.971458);
      ai->SetW(0.0076);
      ai = &bai->NewIsotope();
      ai->SetMr(33.967867);
      ai->SetW(0.0429);
      ai = &bai->NewIsotope();
      ai->SetMr(35.967081);
      ai->SetW(0.0002);
    bai = &Data.AddNew();
    bai->SetSymbol("Cl");
    bai->SetName("Chlorine");
    bai->SetMr(35.453);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(0.99);
    bai->SetRad2(1.49);
    bai->SetIndex(16);
      ai = &bai->NewIsotope();
      ai->SetMr(34.968853);
      ai->SetW(0.7578);
      ai = &bai->NewIsotope();
      ai->SetMr(36.965903);
      ai->SetW(0.2422);
    bai = &Data.AddNew();
    bai->SetSymbol("Ar");
    bai->SetName("Argon");
    bai->SetMr(39.948);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.5);
    bai->SetRad2(2);
    bai->SetIndex(17);
      ai = &bai->NewIsotope();
      ai->SetMr(35.967546);
      ai->SetW(0.003365);
      ai = &bai->NewIsotope();
      ai->SetMr(37.962733);
      ai->SetW(0.000632);
      ai = &bai->NewIsotope();
      ai->SetMr(39.962384);
      ai->SetW(0.996003);
    bai = &Data.AddNew();
    bai->SetSymbol("K");
    bai->SetName("Potassium");
    bai->SetMr(39.098);
    bai->SetDefColor(0x808000);
    bai->SetRad(0.25);
    bai->SetRad1(1.27);
    bai->SetRad2(1.77);
    bai->SetIndex(18);
      ai = &bai->NewIsotope();
      ai->SetMr(38.963707);
      ai->SetW(0.932581);
      ai = &bai->NewIsotope();
      ai->SetMr(39.963999);
      ai->SetW(0.000117);
      ai = &bai->NewIsotope();
      ai->SetMr(40.961825);
      ai->SetW(0.067302);
    bai = &Data.AddNew();
    bai->SetSymbol("Ca");
    bai->SetName("Calcium");
    bai->SetMr(40.08);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.25);
    bai->SetRad1(1.97);
    bai->SetRad2(2.47);
    bai->SetIndex(19);
      ai = &bai->NewIsotope();
      ai->SetMr(39.962591);
      ai->SetW(0.96941);
      ai = &bai->NewIsotope();
      ai->SetMr(41.958618);
      ai->SetW(0.00647);
      ai = &bai->NewIsotope();
      ai->SetMr(42.958766);
      ai->SetW(0.00135);
      ai = &bai->NewIsotope();
      ai->SetMr(43.955481);
      ai->SetW(0.02086);
      ai = &bai->NewIsotope();
      ai->SetMr(45.953689);
      ai->SetW(0.00004);
      ai = &bai->NewIsotope();
      ai->SetMr(47.952533);
      ai->SetW(0.00187);
    bai = &Data.AddNew();
    bai->SetSymbol("Sc");
    bai->SetName("Scandium");
    bai->SetMr(44.9559);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.25);
    bai->SetRad1(1.61);
    bai->SetRad2(2.11);
    bai->SetIndex(20);
      ai = &bai->NewIsotope();
      ai->SetMr(44.95591);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Ti");
    bai->SetName("Titanium");
    bai->SetMr(47.9);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.25);
    bai->SetRad1(1.45);
    bai->SetRad2(1.95);
    bai->SetIndex(21);
      ai = &bai->NewIsotope();
      ai->SetMr(45.952629);
      ai->SetW(0.0825);
      ai = &bai->NewIsotope();
      ai->SetMr(46.951764);
      ai->SetW(0.0744);
      ai = &bai->NewIsotope();
      ai->SetMr(47.947947);
      ai->SetW(0.7372);
      ai = &bai->NewIsotope();
      ai->SetMr(48.947871);
      ai->SetW(0.0541);
      ai = &bai->NewIsotope();
      ai->SetMr(49.944792);
      ai->SetW(0.0518);
    bai = &Data.AddNew();
    bai->SetSymbol("V");
    bai->SetName("Vanadium");
    bai->SetMr(50.9414);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.25);
    bai->SetRad1(1.31);
    bai->SetRad2(1.81);
    bai->SetIndex(22);
      ai = &bai->NewIsotope();
      ai->SetMr(49.947161);
      ai->SetW(0.0025);
      ai = &bai->NewIsotope();
      ai->SetMr(50.943962);
      ai->SetW(0.9975);
    bai = &Data.AddNew();
    bai->SetSymbol("Cr");
    bai->SetName("Chromium");
    bai->SetMr(51.996);
    bai->SetDefColor(0x800080);
    bai->SetRad(0.25);
    bai->SetRad1(1.24);
    bai->SetRad2(1.74);
    bai->SetIndex(23);
      ai = &bai->NewIsotope();
      ai->SetMr(49.946046);
      ai->SetW(0.04345);
      ai = &bai->NewIsotope();
      ai->SetMr(51.94051);
      ai->SetW(0.83789);
      ai = &bai->NewIsotope();
      ai->SetMr(52.940651);
      ai->SetW(0.09501);
      ai = &bai->NewIsotope();
      ai->SetMr(53.938882);
      ai->SetW(0.02365);
    bai = &Data.AddNew();
    bai->SetSymbol("Mn");
    bai->SetName("Manganese");
    bai->SetMr(54.938);
    bai->SetDefColor(0x808000);
    bai->SetRad(0.25);
    bai->SetRad1(1.37);
    bai->SetRad2(1.87);
    bai->SetIndex(24);
      ai = &bai->NewIsotope();
      ai->SetMr(54.938047);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Fe");
    bai->SetName("Iron");
    bai->SetMr(55.847);
    bai->SetDefColor(0xFF);
    bai->SetRad(0.25);
    bai->SetRad1(1.24);
    bai->SetRad2(1.74);
    bai->SetIndex(25);
      ai = &bai->NewIsotope();
      ai->SetMr(53.939613);
      ai->SetW(0.05845);
      ai = &bai->NewIsotope();
      ai->SetMr(55.934939);
      ai->SetW(0.91754);
      ai = &bai->NewIsotope();
      ai->SetMr(56.935396);
      ai->SetW(0.02119);
      ai = &bai->NewIsotope();
      ai->SetMr(57.933277);
      ai->SetW(0.00282);
    bai = &Data.AddNew();
    bai->SetSymbol("Co");
    bai->SetName("Cobalt");
    bai->SetMr(58.9332);
    bai->SetDefColor(0xFF0000);
    bai->SetRad(0.25);
    bai->SetRad1(1.25);
    bai->SetRad2(1.75);
    bai->SetIndex(26);
      ai = &bai->NewIsotope();
      ai->SetMr(58.933198);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Ni");
    bai->SetName("Nickel");
    bai->SetMr(58.71);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.25);
    bai->SetRad1(1.25);
    bai->SetRad2(1.75);
    bai->SetIndex(27);
      ai = &bai->NewIsotope();
      ai->SetMr(57.935346);
      ai->SetW(0.680769);
      ai = &bai->NewIsotope();
      ai->SetMr(59.930788);
      ai->SetW(0.26223);
      ai = &bai->NewIsotope();
      ai->SetMr(60.931058);
      ai->SetW(0.011399);
      ai = &bai->NewIsotope();
      ai->SetMr(61.928346);
      ai->SetW(0.036345);
      ai = &bai->NewIsotope();
      ai->SetMr(63.927968);
      ai->SetW(0.009256);
    bai = &Data.AddNew();
    bai->SetSymbol("Cu");
    bai->SetName("Copper");
    bai->SetMr(63.546);
    bai->SetDefColor(0xFF);
    bai->SetRad(0.25);
    bai->SetRad1(1.28);
    bai->SetRad2(1.78);
    bai->SetIndex(28);
      ai = &bai->NewIsotope();
      ai->SetMr(62.929599);
      ai->SetW(0.6917);
      ai = &bai->NewIsotope();
      ai->SetMr(64.927793);
      ai->SetW(0.3083);
    bai = &Data.AddNew();
    bai->SetSymbol("Zn");
    bai->SetName("Zinc");
    bai->SetMr(63.38);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.25);
    bai->SetRad1(1.33);
    bai->SetRad2(1.83);
    bai->SetIndex(29);
      ai = &bai->NewIsotope();
      ai->SetMr(63.929145);
      ai->SetW(0.4863);
      ai = &bai->NewIsotope();
      ai->SetMr(65.926035);
      ai->SetW(0.279);
      ai = &bai->NewIsotope();
      ai->SetMr(66.927129);
      ai->SetW(0.041);
      ai = &bai->NewIsotope();
      ai->SetMr(67.924846);
      ai->SetW(0.1875);
      ai = &bai->NewIsotope();
      ai->SetMr(69.925325);
      ai->SetW(0.0062);
    bai = &Data.AddNew();
    bai->SetSymbol("Ga");
    bai->SetName("Gallium");
    bai->SetMr(69.72);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.26);
    bai->SetRad2(1.76);
    bai->SetIndex(30);
      ai = &bai->NewIsotope();
      ai->SetMr(68.92558);
      ai->SetW(0.60108);
      ai = &bai->NewIsotope();
      ai->SetMr(70.924701);
      ai->SetW(0.39892);
    bai = &Data.AddNew();
    bai->SetSymbol("Ge");
    bai->SetName("Germanium");
    bai->SetMr(72.59);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.22);
    bai->SetRad2(1.72);
    bai->SetIndex(31);
      ai = &bai->NewIsotope();
      ai->SetMr(69.92425);
      ai->SetW(0.2084);
      ai = &bai->NewIsotope();
      ai->SetMr(71.922079);
      ai->SetW(0.2754);
      ai = &bai->NewIsotope();
      ai->SetMr(72.923463);
      ai->SetW(0.0773);
      ai = &bai->NewIsotope();
      ai->SetMr(73.921177);
      ai->SetW(0.3628);
      ai = &bai->NewIsotope();
      ai->SetMr(75.921402);
      ai->SetW(0.0761);
    bai = &Data.AddNew();
    bai->SetSymbol("As");
    bai->SetName("Arsenic");
    bai->SetMr(74.9216);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.21);
    bai->SetRad2(1.71);
    bai->SetIndex(32);
      ai = &bai->NewIsotope();
      ai->SetMr(74.921594);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Se");
    bai->SetName("Selenium");
    bai->SetMr(78.96);
    bai->SetDefColor(0xFFFF);
    bai->SetRad(0.3);
    bai->SetRad1(1.17);
    bai->SetRad2(1.67);
    bai->SetIndex(33);
      ai = &bai->NewIsotope();
      ai->SetMr(73.922475);
      ai->SetW(0.0089);
      ai = &bai->NewIsotope();
      ai->SetMr(75.919212);
      ai->SetW(0.0937);
      ai = &bai->NewIsotope();
      ai->SetMr(76.919912);
      ai->SetW(0.0763);
      ai = &bai->NewIsotope();
      ai->SetMr(77.917308);
      ai->SetW(0.2377);
      ai = &bai->NewIsotope();
      ai->SetMr(79.91652);
      ai->SetW(0.4961);
      ai = &bai->NewIsotope();
      ai->SetMr(81.916698);
      ai->SetW(0.0873);
    bai = &Data.AddNew();
    bai->SetSymbol("Br");
    bai->SetName("Bromine");
    bai->SetMr(79.904);
    bai->SetDefColor(0xFF);
    bai->SetRad(0.3);
    bai->SetRad1(1.14);
    bai->SetRad2(1.64);
    bai->SetIndex(34);
      ai = &bai->NewIsotope();
      ai->SetMr(78.918336);
      ai->SetW(0.5069);
      ai = &bai->NewIsotope();
      ai->SetMr(80.916289);
      ai->SetW(0.4931);
    bai = &Data.AddNew();
    bai->SetSymbol("Kr");
    bai->SetName("Krypton");
    bai->SetMr(83.8);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.5);
    bai->SetRad2(2);
    bai->SetIndex(35);
      ai = &bai->NewIsotope();
      ai->SetMr(77.920396);
      ai->SetW(0.0035);
      ai = &bai->NewIsotope();
      ai->SetMr(79.91638);
      ai->SetW(0.0228);
      ai = &bai->NewIsotope();
      ai->SetMr(81.913482);
      ai->SetW(0.1158);
      ai = &bai->NewIsotope();
      ai->SetMr(82.914135);
      ai->SetW(0.1149);
      ai = &bai->NewIsotope();
      ai->SetMr(83.911507);
      ai->SetW(0.57);
      ai = &bai->NewIsotope();
      ai->SetMr(85.910616);
      ai->SetW(0.173);
    bai = &Data.AddNew();
    bai->SetSymbol("Rb");
    bai->SetName("Rubidium");
    bai->SetMr(85.4678);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(2.48);
    bai->SetRad2(2.98);
    bai->SetIndex(36);
      ai = &bai->NewIsotope();
      ai->SetMr(84.911794);
      ai->SetW(0.7217);
      ai = &bai->NewIsotope();
      ai->SetMr(86.909187);
      ai->SetW(0.2783);
    bai = &Data.AddNew();
    bai->SetSymbol("Sr");
    bai->SetName("Strontium");
    bai->SetMr(87.62);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.15);
    bai->SetRad2(1.65);
    bai->SetIndex(37);
      ai = &bai->NewIsotope();
      ai->SetMr(83.91343);
      ai->SetW(0.0056);
      ai = &bai->NewIsotope();
      ai->SetMr(85.909267);
      ai->SetW(0.0986);
      ai = &bai->NewIsotope();
      ai->SetMr(86.908884);
      ai->SetW(0.07);
      ai = &bai->NewIsotope();
      ai->SetMr(87.905619);
      ai->SetW(0.8258);
    bai = &Data.AddNew();
    bai->SetSymbol("Y");
    bai->SetName("Yttrium");
    bai->SetMr(88.9059);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.78);
    bai->SetRad2(2.28);
    bai->SetIndex(38);
      ai = &bai->NewIsotope();
      ai->SetMr(89.905849);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Zr");
    bai->SetName("Zirconium");
    bai->SetMr(91.22);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.59);
    bai->SetRad2(2.09);
    bai->SetIndex(39);
      ai = &bai->NewIsotope();
      ai->SetMr(89.904703);
      ai->SetW(0.5145);
      ai = &bai->NewIsotope();
      ai->SetMr(90.905644);
      ai->SetW(0.1122);
      ai = &bai->NewIsotope();
      ai->SetMr(91.905039);
      ai->SetW(0.1715);
      ai = &bai->NewIsotope();
      ai->SetMr(93.906315);
      ai->SetW(0.1738);
      ai = &bai->NewIsotope();
      ai->SetMr(95.908275);
      ai->SetW(0.028);
    bai = &Data.AddNew();
    bai->SetSymbol("Nb");
    bai->SetName("Niobium");
    bai->SetMr(92.9064);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.43);
    bai->SetRad2(1.93);
    bai->SetIndex(40);
      ai = &bai->NewIsotope();
      ai->SetMr(92.906377);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Mo");
    bai->SetName("Molybdenum");
    bai->SetMr(95.94);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.36);
    bai->SetRad2(1.86);
    bai->SetIndex(41);
      ai = &bai->NewIsotope();
      ai->SetMr(91.906809);
      ai->SetW(0.1484);
      ai = &bai->NewIsotope();
      ai->SetMr(93.905085);
      ai->SetW(0.0925);
      ai = &bai->NewIsotope();
      ai->SetMr(94.905841);
      ai->SetW(0.1592);
      ai = &bai->NewIsotope();
      ai->SetMr(95.904679);
      ai->SetW(0.1668);
      ai = &bai->NewIsotope();
      ai->SetMr(96.90602);
      ai->SetW(0.0955);
      ai = &bai->NewIsotope();
      ai->SetMr(97.905407);
      ai->SetW(0.2413);
      ai = &bai->NewIsotope();
      ai->SetMr(99.907477);
      ai->SetW(0.0963);
    bai = &Data.AddNew();
    bai->SetSymbol("Tc");
    bai->SetName("Technetium");
    bai->SetMr(98.9062);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.35);
    bai->SetRad2(1.85);
    bai->SetIndex(42);
    bai = &Data.AddNew();
    bai->SetSymbol("Ru");
    bai->SetName("Ruthenium");
    bai->SetMr(101.07);
    bai->SetDefColor(0xFF);
    bai->SetRad(0.3);
    bai->SetRad1(1.33);
    bai->SetRad2(1.83);
    bai->SetIndex(43);
      ai = &bai->NewIsotope();
      ai->SetMr(95.907599);
      ai->SetW(0.0554);
      ai = &bai->NewIsotope();
      ai->SetMr(97.905287);
      ai->SetW(0.0187);
      ai = &bai->NewIsotope();
      ai->SetMr(98.905939);
      ai->SetW(0.1276);
      ai = &bai->NewIsotope();
      ai->SetMr(99.904219);
      ai->SetW(0.126);
      ai = &bai->NewIsotope();
      ai->SetMr(100.905582);
      ai->SetW(0.1706);
      ai = &bai->NewIsotope();
      ai->SetMr(101.904349);
      ai->SetW(0.3155);
      ai = &bai->NewIsotope();
      ai->SetMr(103.905424);
      ai->SetW(0.1862);
    bai = &Data.AddNew();
    bai->SetSymbol("Rh");
    bai->SetName("Rhodium");
    bai->SetMr(102.9055);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.35);
    bai->SetRad2(1.85);
    bai->SetIndex(44);
      ai = &bai->NewIsotope();
      ai->SetMr(102.9055);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Pd");
    bai->SetName("Palladium");
    bai->SetMr(106.4);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.38);
    bai->SetRad2(1.88);
    bai->SetIndex(45);
      ai = &bai->NewIsotope();
      ai->SetMr(101.905634);
      ai->SetW(0.0102);
      ai = &bai->NewIsotope();
      ai->SetMr(103.904029);
      ai->SetW(0.1114);
      ai = &bai->NewIsotope();
      ai->SetMr(104.905079);
      ai->SetW(0.2233);
      ai = &bai->NewIsotope();
      ai->SetMr(105.903478);
      ai->SetW(0.2733);
      ai = &bai->NewIsotope();
      ai->SetMr(107.903895);
      ai->SetW(0.2646);
      ai = &bai->NewIsotope();
      ai->SetMr(109.905167);
      ai->SetW(0.1172);
    bai = &Data.AddNew();
    bai->SetSymbol("Ag");
    bai->SetName("Silver");
    bai->SetMr(107.868);
    bai->SetDefColor(0x800000);
    bai->SetRad(0.3);
    bai->SetRad1(1.44);
    bai->SetRad2(1.94);
    bai->SetIndex(46);
      ai = &bai->NewIsotope();
      ai->SetMr(106.905092);
      ai->SetW(0.51839);
      ai = &bai->NewIsotope();
      ai->SetMr(108.904756);
      ai->SetW(0.48161);
    bai = &Data.AddNew();
    bai->SetSymbol("Cd");
    bai->SetName("Cadmium");
    bai->SetMr(112.4);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.49);
    bai->SetRad2(1.99);
    bai->SetIndex(47);
      ai = &bai->NewIsotope();
      ai->SetMr(105.906461);
      ai->SetW(0.0125);
      ai = &bai->NewIsotope();
      ai->SetMr(107.904176);
      ai->SetW(0.0089);
      ai = &bai->NewIsotope();
      ai->SetMr(109.903005);
      ai->SetW(0.1249);
      ai = &bai->NewIsotope();
      ai->SetMr(110.904182);
      ai->SetW(0.128);
      ai = &bai->NewIsotope();
      ai->SetMr(111.902757);
      ai->SetW(0.2413);
      ai = &bai->NewIsotope();
      ai->SetMr(112.9044);
      ai->SetW(0.1222);
      ai = &bai->NewIsotope();
      ai->SetMr(113.903357);
      ai->SetW(0.2873);
      ai = &bai->NewIsotope();
      ai->SetMr(115.904755);
      ai->SetW(0.0749);
    bai = &Data.AddNew();
    bai->SetSymbol("In");
    bai->SetName("Indium");
    bai->SetMr(114.82);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.44);
    bai->SetRad2(1.94);
    bai->SetIndex(48);
      ai = &bai->NewIsotope();
      ai->SetMr(112.904061);
      ai->SetW(0.0429);
      ai = &bai->NewIsotope();
      ai->SetMr(114.903882);
      ai->SetW(0.9571);
    bai = &Data.AddNew();
    bai->SetSymbol("Sn");
    bai->SetName("Tin");
    bai->SetMr(118.69);
    bai->SetDefColor(0xFFFF);
    bai->SetRad(0.3);
    bai->SetRad1(1.4);
    bai->SetRad2(1.9);
    bai->SetIndex(49);
      ai = &bai->NewIsotope();
      ai->SetMr(111.904826);
      ai->SetW(0.0097);
      ai = &bai->NewIsotope();
      ai->SetMr(113.902784);
      ai->SetW(0.0066);
      ai = &bai->NewIsotope();
      ai->SetMr(114.903348);
      ai->SetW(0.0034);
      ai = &bai->NewIsotope();
      ai->SetMr(115.901747);
      ai->SetW(0.1454);
      ai = &bai->NewIsotope();
      ai->SetMr(116.902956);
      ai->SetW(0.0768);
      ai = &bai->NewIsotope();
      ai->SetMr(117.901609);
      ai->SetW(0.2422);
      ai = &bai->NewIsotope();
      ai->SetMr(118.903311);
      ai->SetW(0.0859);
      ai = &bai->NewIsotope();
      ai->SetMr(119.902199);
      ai->SetW(0.3258);
      ai = &bai->NewIsotope();
      ai->SetMr(121.90344);
      ai->SetW(0.0463);
      ai = &bai->NewIsotope();
      ai->SetMr(123.905274);
      ai->SetW(0.0579);
    bai = &Data.AddNew();
    bai->SetSymbol("Sb");
    bai->SetName("Antimony");
    bai->SetMr(121.75);
    bai->SetDefColor(0xFF);
    bai->SetRad(0.3);
    bai->SetRad1(1.41);
    bai->SetRad2(1.91);
    bai->SetIndex(50);
      ai = &bai->NewIsotope();
      ai->SetMr(120.903821);
      ai->SetW(0.5721);
      ai = &bai->NewIsotope();
      ai->SetMr(122.904216);
      ai->SetW(0.4279);
    bai = &Data.AddNew();
    bai->SetSymbol("Te");
    bai->SetName("Tellurium");
    bai->SetMr(127.6);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.37);
    bai->SetRad2(1.87);
    bai->SetIndex(51);
      ai = &bai->NewIsotope();
      ai->SetMr(119.904048);
      ai->SetW(0.0009);
      ai = &bai->NewIsotope();
      ai->SetMr(121.90305);
      ai->SetW(0.0255);
      ai = &bai->NewIsotope();
      ai->SetMr(122.904271);
      ai->SetW(0.0089);
      ai = &bai->NewIsotope();
      ai->SetMr(123.902818);
      ai->SetW(0.0474);
      ai = &bai->NewIsotope();
      ai->SetMr(124.904428);
      ai->SetW(0.0707);
      ai = &bai->NewIsotope();
      ai->SetMr(125.90331);
      ai->SetW(0.1884);
      ai = &bai->NewIsotope();
      ai->SetMr(127.904463);
      ai->SetW(0.3174);
      ai = &bai->NewIsotope();
      ai->SetMr(129.906229);
      ai->SetW(0.3408);
    bai = &Data.AddNew();
    bai->SetSymbol("I");
    bai->SetName("Iodine");
    bai->SetMr(126.9045);
    bai->SetDefColor(0x800080);
    bai->SetRad(0.3);
    bai->SetRad1(1.33);
    bai->SetRad2(1.83);
    bai->SetIndex(52);
      ai = &bai->NewIsotope();
      ai->SetMr(126.904473);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Xe");
    bai->SetName("Xenon");
    bai->SetMr(131.3);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.5);
    bai->SetRad2(2);
    bai->SetIndex(53);
      ai = &bai->NewIsotope();
      ai->SetMr(123.905894);
      ai->SetW(0.0009);
      ai = &bai->NewIsotope();
      ai->SetMr(125.904281);
      ai->SetW(0.0009);
      ai = &bai->NewIsotope();
      ai->SetMr(127.903531);
      ai->SetW(0.0192);
      ai = &bai->NewIsotope();
      ai->SetMr(128.90478);
      ai->SetW(0.2644);
      ai = &bai->NewIsotope();
      ai->SetMr(129.903509);
      ai->SetW(0.0408);
      ai = &bai->NewIsotope();
      ai->SetMr(130.905072);
      ai->SetW(0.2118);
      ai = &bai->NewIsotope();
      ai->SetMr(131.904144);
      ai->SetW(0.2689);
      ai = &bai->NewIsotope();
      ai->SetMr(133.905395);
      ai->SetW(0.1044);
      ai = &bai->NewIsotope();
      ai->SetMr(135.907214);
      ai->SetW(0.0887);
    bai = &Data.AddNew();
    bai->SetSymbol("Cs");
    bai->SetName("Cesium");
    bai->SetMr(132.9054);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(2.65);
    bai->SetRad2(3.15);
    bai->SetIndex(54);
      ai = &bai->NewIsotope();
      ai->SetMr(132.905429);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Ba");
    bai->SetName("Barium");
    bai->SetMr(137.34);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(2.17);
    bai->SetRad2(2.67);
    bai->SetIndex(55);
      ai = &bai->NewIsotope();
      ai->SetMr(129.906282);
      ai->SetW(0.00106);
      ai = &bai->NewIsotope();
      ai->SetMr(131.905042);
      ai->SetW(0.00101);
      ai = &bai->NewIsotope();
      ai->SetMr(133.904486);
      ai->SetW(0.02417);
      ai = &bai->NewIsotope();
      ai->SetMr(134.905665);
      ai->SetW(0.06592);
      ai = &bai->NewIsotope();
      ai->SetMr(135.904553);
      ai->SetW(0.07854);
      ai = &bai->NewIsotope();
      ai->SetMr(136.905812);
      ai->SetW(0.11232);
      ai = &bai->NewIsotope();
      ai->SetMr(137.905232);
      ai->SetW(0.71698);
    bai = &Data.AddNew();
    bai->SetSymbol("La");
    bai->SetName("Lanthanum");
    bai->SetMr(138.9055);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.87);
    bai->SetRad2(2.37);
    bai->SetIndex(56);
      ai = &bai->NewIsotope();
      ai->SetMr(137.907105);
      ai->SetW(0.0009);
      ai = &bai->NewIsotope();
      ai->SetMr(138.906347);
      ai->SetW(0.9991);
    bai = &Data.AddNew();
    bai->SetSymbol("Ce");
    bai->SetName("Cerium");
    bai->SetMr(140.12);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.83);
    bai->SetRad2(2.33);
    bai->SetIndex(57);
      ai = &bai->NewIsotope();
      ai->SetMr(135.90714);
      ai->SetW(0.00185);
      ai = &bai->NewIsotope();
      ai->SetMr(137.905985);
      ai->SetW(0.00251);
      ai = &bai->NewIsotope();
      ai->SetMr(139.905433);
      ai->SetW(0.8845);
      ai = &bai->NewIsotope();
      ai->SetMr(141.909241);
      ai->SetW(0.11114);
    bai = &Data.AddNew();
    bai->SetSymbol("Pr");
    bai->SetName("Praseodymium");
    bai->SetMr(140.9077);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.82);
    bai->SetRad2(2.32);
    bai->SetIndex(58);
      ai = &bai->NewIsotope();
      ai->SetMr(140.907647);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Nd");
    bai->SetName("Neodymium");
    bai->SetMr(144.24);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.81);
    bai->SetRad2(2.31);
    bai->SetIndex(59);
      ai = &bai->NewIsotope();
      ai->SetMr(141.907719);
      ai->SetW(0.272);
      ai = &bai->NewIsotope();
      ai->SetMr(142.90981);
      ai->SetW(0.122);
      ai = &bai->NewIsotope();
      ai->SetMr(143.910083);
      ai->SetW(0.238);
      ai = &bai->NewIsotope();
      ai->SetMr(144.91257);
      ai->SetW(0.083);
      ai = &bai->NewIsotope();
      ai->SetMr(145.913113);
      ai->SetW(0.172);
      ai = &bai->NewIsotope();
      ai->SetMr(147.916889);
      ai->SetW(0.057);
      ai = &bai->NewIsotope();
      ai->SetMr(149.920887);
      ai->SetW(0.056);
    bai = &Data.AddNew();
    bai->SetSymbol("Pm");
    bai->SetName("Promethium");
    bai->SetMr(145);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.81);
    bai->SetRad2(2.31);
    bai->SetIndex(60);
    bai = &Data.AddNew();
    bai->SetSymbol("Sm");
    bai->SetName("Samarium");
    bai->SetMr(150.4);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(61);
      ai = &bai->NewIsotope();
      ai->SetMr(143.911998);
      ai->SetW(0.0307);
      ai = &bai->NewIsotope();
      ai->SetMr(146.914894);
      ai->SetW(0.1499);
      ai = &bai->NewIsotope();
      ai->SetMr(147.914819);
      ai->SetW(0.1124);
      ai = &bai->NewIsotope();
      ai->SetMr(148.91718);
      ai->SetW(0.1382);
      ai = &bai->NewIsotope();
      ai->SetMr(149.917273);
      ai->SetW(0.0738);
      ai = &bai->NewIsotope();
      ai->SetMr(151.919728);
      ai->SetW(0.2675);
      ai = &bai->NewIsotope();
      ai->SetMr(153.922205);
      ai->SetW(0.2275);
    bai = &Data.AddNew();
    bai->SetSymbol("Eu");
    bai->SetName("Europium");
    bai->SetMr(151.96);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(2);
    bai->SetRad2(2.5);
    bai->SetIndex(62);
      ai = &bai->NewIsotope();
      ai->SetMr(150.919702);
      ai->SetW(0.4781);
      ai = &bai->NewIsotope();
      ai->SetMr(152.921225);
      ai->SetW(0.5219);
    bai = &Data.AddNew();
    bai->SetSymbol("Gd");
    bai->SetName("Gadolinium");
    bai->SetMr(157.25);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.79);
    bai->SetRad2(2.29);
    bai->SetIndex(63);
      ai = &bai->NewIsotope();
      ai->SetMr(151.919786);
      ai->SetW(0.002);
      ai = &bai->NewIsotope();
      ai->SetMr(153.920861);
      ai->SetW(0.0218);
      ai = &bai->NewIsotope();
      ai->SetMr(154.922618);
      ai->SetW(0.148);
      ai = &bai->NewIsotope();
      ai->SetMr(155.922118);
      ai->SetW(0.2047);
      ai = &bai->NewIsotope();
      ai->SetMr(156.923956);
      ai->SetW(0.1565);
      ai = &bai->NewIsotope();
      ai->SetMr(157.924019);
      ai->SetW(0.2484);
      ai = &bai->NewIsotope();
      ai->SetMr(159.927049);
      ai->SetW(0.2186);
    bai = &Data.AddNew();
    bai->SetSymbol("Tb");
    bai->SetName("Terbium");
    bai->SetMr(158.9254);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.76);
    bai->SetRad2(2.26);
    bai->SetIndex(64);
      ai = &bai->NewIsotope();
      ai->SetMr(158.925342);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Dy");
    bai->SetName("Dysprosium");
    bai->SetMr(162.5);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.75);
    bai->SetRad2(2.25);
    bai->SetIndex(65);
      ai = &bai->NewIsotope();
      ai->SetMr(155.924277);
      ai->SetW(0.0006);
      ai = &bai->NewIsotope();
      ai->SetMr(157.924403);
      ai->SetW(0.001);
      ai = &bai->NewIsotope();
      ai->SetMr(159.925193);
      ai->SetW(0.0234);
      ai = &bai->NewIsotope();
      ai->SetMr(160.92693);
      ai->SetW(0.1891);
      ai = &bai->NewIsotope();
      ai->SetMr(161.926795);
      ai->SetW(0.2551);
      ai = &bai->NewIsotope();
      ai->SetMr(162.928728);
      ai->SetW(0.249);
      ai = &bai->NewIsotope();
      ai->SetMr(163.929171);
      ai->SetW(0.2818);
    bai = &Data.AddNew();
    bai->SetSymbol("Ho");
    bai->SetName("Holmium");
    bai->SetMr(164.9304);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.74);
    bai->SetRad2(2.24);
    bai->SetIndex(66);
      ai = &bai->NewIsotope();
      ai->SetMr(164.930319);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Er");
    bai->SetName("Erbium");
    bai->SetMr(167.26);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.73);
    bai->SetRad2(2.23);
    bai->SetIndex(67);
      ai = &bai->NewIsotope();
      ai->SetMr(161.928775);
      ai->SetW(0.0014);
      ai = &bai->NewIsotope();
      ai->SetMr(163.929198);
      ai->SetW(0.0161);
      ai = &bai->NewIsotope();
      ai->SetMr(165.93029);
      ai->SetW(0.3361);
      ai = &bai->NewIsotope();
      ai->SetMr(166.932046);
      ai->SetW(0.2293);
      ai = &bai->NewIsotope();
      ai->SetMr(167.932368);
      ai->SetW(0.2678);
      ai = &bai->NewIsotope();
      ai->SetMr(169.935461);
      ai->SetW(0.1493);
    bai = &Data.AddNew();
    bai->SetSymbol("Tm");
    bai->SetName("Thulium");
    bai->SetMr(168.9342);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.72);
    bai->SetRad2(2.22);
    bai->SetIndex(68);
      ai = &bai->NewIsotope();
      ai->SetMr(168.934212);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Yb");
    bai->SetName("Ytterbium");
    bai->SetMr(173.04);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.94);
    bai->SetRad2(2.44);
    bai->SetIndex(69);
      ai = &bai->NewIsotope();
      ai->SetMr(167.933894);
      ai->SetW(0.0013);
      ai = &bai->NewIsotope();
      ai->SetMr(169.934759);
      ai->SetW(0.0304);
      ai = &bai->NewIsotope();
      ai->SetMr(170.936323);
      ai->SetW(0.1428);
      ai = &bai->NewIsotope();
      ai->SetMr(171.936378);
      ai->SetW(0.2183);
      ai = &bai->NewIsotope();
      ai->SetMr(172.938208);
      ai->SetW(0.1613);
      ai = &bai->NewIsotope();
      ai->SetMr(173.938859);
      ai->SetW(0.3183);
      ai = &bai->NewIsotope();
      ai->SetMr(175.942564);
      ai->SetW(0.1276);
    bai = &Data.AddNew();
    bai->SetSymbol("Lu");
    bai->SetName("Lutetium");
    bai->SetMr(174.97);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.72);
    bai->SetRad2(2.22);
    bai->SetIndex(70);
      ai = &bai->NewIsotope();
      ai->SetMr(174.94077);
      ai->SetW(0.9741);
      ai = &bai->NewIsotope();
      ai->SetMr(175.942679);
      ai->SetW(0.0259);
    bai = &Data.AddNew();
    bai->SetSymbol("Hf");
    bai->SetName("Hafnium");
    bai->SetMr(178.49);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.56);
    bai->SetRad2(2.06);
    bai->SetIndex(71);
      ai = &bai->NewIsotope();
      ai->SetMr(173.940044);
      ai->SetW(0.0016);
      ai = &bai->NewIsotope();
      ai->SetMr(175.941406);
      ai->SetW(0.0526);
      ai = &bai->NewIsotope();
      ai->SetMr(176.943217);
      ai->SetW(0.186);
      ai = &bai->NewIsotope();
      ai->SetMr(177.943696);
      ai->SetW(0.2728);
      ai = &bai->NewIsotope();
      ai->SetMr(178.945812);
      ai->SetW(0.1362);
      ai = &bai->NewIsotope();
      ai->SetMr(179.946546);
      ai->SetW(0.3508);
    bai = &Data.AddNew();
    bai->SetSymbol("Ta");
    bai->SetName("Tantalum");
    bai->SetMr(180.9479);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.43);
    bai->SetRad2(1.93);
    bai->SetIndex(72);
      ai = &bai->NewIsotope();
      ai->SetMr(179.947462);
      ai->SetW(0.00012);
      ai = &bai->NewIsotope();
      ai->SetMr(180.947992);
      ai->SetW(0.99988);
    bai = &Data.AddNew();
    bai->SetSymbol("W");
    bai->SetName("Tungsten");
    bai->SetMr(183.85);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.37);
    bai->SetRad2(1.87);
    bai->SetIndex(73);
      ai = &bai->NewIsotope();
      ai->SetMr(179.946701);
      ai->SetW(0.0012);
      ai = &bai->NewIsotope();
      ai->SetMr(181.948202);
      ai->SetW(0.265);
      ai = &bai->NewIsotope();
      ai->SetMr(182.95022);
      ai->SetW(0.1431);
      ai = &bai->NewIsotope();
      ai->SetMr(183.950928);
      ai->SetW(0.3064);
      ai = &bai->NewIsotope();
      ai->SetMr(185.954357);
      ai->SetW(0.2843);
    bai = &Data.AddNew();
    bai->SetSymbol("Re");
    bai->SetName("Rhenium");
    bai->SetMr(186.2);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.37);
    bai->SetRad2(1.87);
    bai->SetIndex(74);
      ai = &bai->NewIsotope();
      ai->SetMr(184.952951);
      ai->SetW(0.374);
      ai = &bai->NewIsotope();
      ai->SetMr(186.955744);
      ai->SetW(0.626);
    bai = &Data.AddNew();
    bai->SetSymbol("Os");
    bai->SetName("Osmium");
    bai->SetMr(190.2);
    bai->SetDefColor(0x800000);
    bai->SetRad(0.3);
    bai->SetRad1(1.34);
    bai->SetRad2(1.84);
    bai->SetIndex(75);
      ai = &bai->NewIsotope();
      ai->SetMr(183.952488);
      ai->SetW(0.0002);
      ai = &bai->NewIsotope();
      ai->SetMr(185.95383);
      ai->SetW(0.0159);
      ai = &bai->NewIsotope();
      ai->SetMr(186.955741);
      ai->SetW(0.0196);
      ai = &bai->NewIsotope();
      ai->SetMr(187.95583);
      ai->SetW(0.1324);
      ai = &bai->NewIsotope();
      ai->SetMr(188.958137);
      ai->SetW(0.1615);
      ai = &bai->NewIsotope();
      ai->SetMr(189.958436);
      ai->SetW(0.2626);
      ai = &bai->NewIsotope();
      ai->SetMr(191.961467);
      ai->SetW(0.4078);
    bai = &Data.AddNew();
    bai->SetSymbol("Ir");
    bai->SetName("Iridium");
    bai->SetMr(192.22);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.36);
    bai->SetRad2(1.86);
    bai->SetIndex(76);
      ai = &bai->NewIsotope();
      ai->SetMr(190.960584);
      ai->SetW(0.373);
      ai = &bai->NewIsotope();
      ai->SetMr(192.962917);
      ai->SetW(0.627);
    bai = &Data.AddNew();
    bai->SetSymbol("Pt");
    bai->SetName("Platinum");
    bai->SetMr(195.09);
    bai->SetDefColor(0x800000);
    bai->SetRad(0.3);
    bai->SetRad1(1.37);
    bai->SetRad2(1.87);
    bai->SetIndex(77);
      ai = &bai->NewIsotope();
      ai->SetMr(189.959917);
      ai->SetW(0.00014);
      ai = &bai->NewIsotope();
      ai->SetMr(191.961019);
      ai->SetW(0.00782);
      ai = &bai->NewIsotope();
      ai->SetMr(193.962655);
      ai->SetW(0.32967);
      ai = &bai->NewIsotope();
      ai->SetMr(194.964766);
      ai->SetW(0.33832);
      ai = &bai->NewIsotope();
      ai->SetMr(195.964926);
      ai->SetW(0.25242);
      ai = &bai->NewIsotope();
      ai->SetMr(197.967869);
      ai->SetW(0.07163);
    bai = &Data.AddNew();
    bai->SetSymbol("Au");
    bai->SetName("Gold");
    bai->SetMr(196.9665);
    bai->SetDefColor(0xFFFF);
    bai->SetRad(0.3);
    bai->SetRad1(1.44);
    bai->SetRad2(1.94);
    bai->SetIndex(78);
      ai = &bai->NewIsotope();
      ai->SetMr(196.966543);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Hg");
    bai->SetName("Mercury");
    bai->SetMr(200.59);
    bai->SetDefColor(0xFFFF);
    bai->SetRad(0.3);
    bai->SetRad1(1.5);
    bai->SetRad2(2);
    bai->SetIndex(79);
      ai = &bai->NewIsotope();
      ai->SetMr(196.966543);
      ai->SetW(0.0015);
      ai = &bai->NewIsotope();
      ai->SetMr(197.966743);
      ai->SetW(0.0997);
      ai = &bai->NewIsotope();
      ai->SetMr(198.968254);
      ai->SetW(0.1687);
      ai = &bai->NewIsotope();
      ai->SetMr(199.9683);
      ai->SetW(0.231);
      ai = &bai->NewIsotope();
      ai->SetMr(200.970277);
      ai->SetW(0.1318);
      ai = &bai->NewIsotope();
      ai->SetMr(201.970617);
      ai->SetW(0.2986);
      ai = &bai->NewIsotope();
      ai->SetMr(203.973467);
      ai->SetW(0.0687);
    bai = &Data.AddNew();
    bai->SetSymbol("Tl");
    bai->SetName("Thallium");
    bai->SetMr(204.37);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.64);
    bai->SetRad2(2.14);
    bai->SetIndex(80);
      ai = &bai->NewIsotope();
      ai->SetMr(202.97232);
      ai->SetW(0.29524);
      ai = &bai->NewIsotope();
      ai->SetMr(204.974401);
      ai->SetW(0.70476);
    bai = &Data.AddNew();
    bai->SetSymbol("Pb");
    bai->SetName("Lead");
    bai->SetMr(207.2);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.6);
    bai->SetRad2(2.1);
    bai->SetIndex(81);
      ai = &bai->NewIsotope();
      ai->SetMr(203.97302);
      ai->SetW(0.014);
      ai = &bai->NewIsotope();
      ai->SetMr(205.97444);
      ai->SetW(0.241);
      ai = &bai->NewIsotope();
      ai->SetMr(206.975872);
      ai->SetW(0.221);
      ai = &bai->NewIsotope();
      ai->SetMr(207.976627);
      ai->SetW(0.524);
    bai = &Data.AddNew();
    bai->SetSymbol("Bi");
    bai->SetName("Bismuth");
    bai->SetMr(208.9804);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.6);
    bai->SetRad2(2.1);
    bai->SetIndex(82);
      ai = &bai->NewIsotope();
      ai->SetMr(208.980374);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Po");
    bai->SetName("Polonium");
    bai->SetMr(209);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.6);
    bai->SetRad2(2.1);
    bai->SetIndex(83);
    bai = &Data.AddNew();
    bai->SetSymbol("At");
    bai->SetName("Astatine");
    bai->SetMr(210);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.6);
    bai->SetRad2(2.1);
    bai->SetIndex(84);
    bai = &Data.AddNew();
    bai->SetSymbol("Rn");
    bai->SetName("Radon");
    bai->SetMr(222);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(85);
    bai = &Data.AddNew();
    bai->SetSymbol("Fr");
    bai->SetName("Francium");
    bai->SetMr(223);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(2.8);
    bai->SetRad2(3.3);
    bai->SetIndex(86);
    bai = &Data.AddNew();
    bai->SetSymbol("Ra");
    bai->SetName("Radium");
    bai->SetMr(226.0254);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(2.2);
    bai->SetRad2(2.7);
    bai->SetIndex(87);
    bai = &Data.AddNew();
    bai->SetSymbol("Ac");
    bai->SetName("Actinium");
    bai->SetMr(227);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.9);
    bai->SetRad2(2.4);
    bai->SetIndex(88);
    bai = &Data.AddNew();
    bai->SetSymbol("Th");
    bai->SetName("Thorium");
    bai->SetMr(232.0381);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.85);
    bai->SetRad2(2.35);
    bai->SetIndex(89);
      ai = &bai->NewIsotope();
      ai->SetMr(232.0381);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("Pa");
    bai->SetName("Protactinium");
    bai->SetMr(231.0359);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(90);
      ai = &bai->NewIsotope();
      ai->SetMr(231.0359);
      ai->SetW(1);
    bai = &Data.AddNew();
    bai->SetSymbol("U");
    bai->SetName("Uranium");
    bai->SetMr(238.029);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(91);
      ai = &bai->NewIsotope();
      ai->SetMr(234.040947);
      ai->SetW(0.000055);
      ai = &bai->NewIsotope();
      ai->SetMr(235.043924);
      ai->SetW(0.0072);
      ai = &bai->NewIsotope();
      ai->SetMr(238.050785);
      ai->SetW(0.992745);
    bai = &Data.AddNew();
    bai->SetSymbol("Np");
    bai->SetName("Neptunium");
    bai->SetMr(237.0482);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(92);
    bai = &Data.AddNew();
    bai->SetSymbol("Pu");
    bai->SetName("Plutonium");
    bai->SetMr(244);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(93);
    bai = &Data.AddNew();
    bai->SetSymbol("Am");
    bai->SetName("Americium");
    bai->SetMr(243);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(94);
    bai = &Data.AddNew();
    bai->SetSymbol("Cm");
    bai->SetName("Curium");
    bai->SetMr(247);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(95);
    bai = &Data.AddNew();
    bai->SetSymbol("Bk");
    bai->SetName("Berkelium");
    bai->SetMr(247);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(96);
    bai = &Data.AddNew();
    bai->SetSymbol("Cf");
    bai->SetName("Californium");
    bai->SetMr(251);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(97);
    bai = &Data.AddNew();
    bai->SetSymbol("Es");
    bai->SetName("Einsteinium");
    bai->SetMr(254);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(98);
    bai = &Data.AddNew();
    bai->SetSymbol("Fm");
    bai->SetName("Fermium");
    bai->SetMr(257);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(99);
    bai = &Data.AddNew();
    bai->SetSymbol("Md");
    bai->SetName("Mendelevium");
    bai->SetMr(258);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(100);
    bai = &Data.AddNew();
    bai->SetSymbol("No");
    bai->SetName("Nobelium");
    bai->SetMr(255);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(101);
    bai = &Data.AddNew();
    bai->SetSymbol("Lr");
    bai->SetName("Lawrencium");
    bai->SetMr(256);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(102);
    bai = &Data.AddNew();
    bai->SetSymbol("Ku");
    bai->SetName("?");
    bai->SetMr(261);
    bai->SetDefColor(0x8000);
    bai->SetRad(0.3);
    bai->SetRad1(1.8);
    bai->SetRad2(2.3);
    bai->SetIndex(103);
    bai = &Data.AddNew();
    bai->SetSymbol("Q");
    bai->SetName("Peak");
    bai->SetMr(0);
    bai->SetDefColor(0x0);
    bai->SetRad(0.2);
    bai->SetRad1(0.77);
    bai->SetRad2(1.27);
    bai->SetIndex(104);
    bai = &Data.AddNew();
    bai->SetSymbol("D");
    bai->SetName("Deuterium");
    bai->SetMr(2.0141);
    bai->SetDefColor(0xFFFFFF);
    bai->SetRad(0.12);
    bai->SetRad1(0.32);
    bai->SetRad2(0.82);
    bai->SetIndex(105);
      ai = &bai->NewIsotope();
      ai->SetMr(1.007825);
      ai->SetW(0.99989);
      ai = &bai->NewIsotope();
      ai->SetMr(2.014102);
      ai->SetW(0.000115);
  }
  Instance = this;
}
//..............................................................................
TAtomsInfo::~TAtomsInfo()  {  
  Instance = NULL;
}
//..............................................................................
void TAtomsInfo::SaveToFile(const olxstr &filename) const  {
  TCStrList L;
  L.Add("XLIB: (c) Oleg V. Dolomanov 2004");
  for( int i=0; i < Count(); i++ )
    L.Add( GetAtomInfo(i).StrRepr() );
  L.SaveToFile( filename );
}
//..............................................................................
TBasicAtomInfo* TAtomsInfo::FindAtomInfoBySymbol(const olxstr &Symbol) const  {
//  static bool running = false;
//  while ( running )  TBasicApp::GetInstance()->Sleep(1);
//  running = true;
  for( int i=0; i < Data.Count(); i++ )
    if( Data[i].GetSymbol().Comparei(Symbol) == 0 )  {
//      running = false;
      return &Data[i];
    }
//  running = false;
  return NULL;
}
//..............................................................................
TBasicAtomInfo* TAtomsInfo::FindAtomInfoEx(const olxstr &Str) const {
  if( !Str.Length() )  return NULL;

  int l = Str.Length(), dl = abs('A'-'a');
  TBasicAtomInfo *I;
  if( l >= 2 &&
    (( (Str[0]>='a' && Str[0]<='z')    ||
       (Str[0]>='A' && Str[0]<='Z') )  &&
    (  (Str[1]>='a' && Str[1]<='z')    ||
       (Str[1]>='A' && Str[1]<='Z') ))   )  {  // searching between two charachter elements
    for( short j=0; j < Data.Count(); j++ )  {
      I = &GetAtomInfo(j);
      if( I->GetSymbol().Length() == 2 )  {
        short da = abs( I->GetSymbol()[0]- Str[0] ),
              db = abs( I->GetSymbol()[1]- Str[1] );
        if( (!da && !db) || (!da && db==dl) || (da==dl && !db) || (da==dl && db==dl) )
          return I;
      }
    }
  }
  if( (Str[0]>='a' && Str[0]<='z') || (Str[0]>='A' && Str[0]<='Z') )  {
    for( short j=0; j < Data.Count(); j++ )  {
      I = &GetAtomInfo(j);
      if( I->GetSymbol().Length() == 1 )  {
        short da = abs( I->GetSymbol()[0]- Str[0] );
        if( (!da) || (da == dl) )
          return I;
      }
    }
  }
  return NULL;
}
//..............................................................................
void TAtomsInfo::ParseSimpleElementStr(const olxstr& str, TStrList& toks)  const {
  olxstr elm;
  for( int i=0; i < str.Length(); i++ )  {
    if( str[i] >= 'A' && str[i] <= 'Z' )  {
      if( elm.Length() )  {
        if( (i+1) < str.Length() )  {
          if( str[i+1] >= 'A' && str[i+1] <= 'Z' )  {
            if( IsElement( elm + str[i+1] ) )  {
              i++;
              toks.Add(elm);
              if( (i+1) < str.Length() )
                elm = str[i];
            }
          }
        }
        if( !IsElement( elm ) )
          throw TFunctionFailedException(__OlxSourceInfo, olxstr("Unknown element - ") << elm);
        toks.Add(elm);
        elm = str[i];
      }
      else
        elm = str[i];
    }
    else
      elm << str[i];
  }
  if( elm.Length() )  {
    if( !IsElement( elm ) )
      throw TFunctionFailedException(__OlxSourceInfo, olxstr("Unknown element - ") << elm);
    toks.Add(elm);
  }
}
//..............................................................................
void TAtomsInfo::ParseElementString(const olxstr& su, TTypeList<AnAssociation2<olxstr, int> >& res)  const {
  olxstr elm, cnt;
  bool nowCnt = false;
  TStrList toks;
  for( int i=0; i < su.Length(); i++ )  {
    if( su[i] == ' ' )  continue;
    if( nowCnt )  {
      if( (su[i] >='0' && su[i] <= '9') || su[i] == '.' )  {
        cnt << su[i];
      }
      else  {
        if( elm.Length() && cnt.Length() )  {
          toks.Clear();
          ParseSimpleElementStr( elm, toks );
          for( int i=0; i < toks.Count()-1; i++ )
            res.AddNew<olxstr, int>(toks.String(i), 1);
          res.AddNew<olxstr, int>(toks.String( toks.Count() -1 ), cnt.ToInt());
          cnt = EmptyString;
        }
        nowCnt = false;
        elm = su[i];
      }
    }
    else  {
      if( !( (su[i] >='0' && su[i] <= '9') || su[i] == '.') )
        elm << su[i];
      else  {
        nowCnt = true;
        cnt = su[i];
      }
    }
  }
  if( elm.Length() )  {
    toks.Clear();
    ParseSimpleElementStr( elm, toks );
    for( int i=0; i < toks.Count()-1; i++ )
      res.AddNew<olxstr, int>(toks.String(i), 1);
    if( cnt.Length() )
      res.AddNew<olxstr, int>(toks.String( toks.Count() -1 ), cnt.ToInt());
    else
      res.AddNew<olxstr, int>(toks.String( toks.Count() -1 ), 1);
  }
}
//..............................................................................

class TLibrary*  ExportLibrary(const olxstr& name);
//..............................................................................

